Shell 程序设计的流程控制



和其他高级程序设计语言一样，Shell 提供了用来控制程序执行流程的命令，包括条件分支和循环结构，用户可以用这些命令创建非常复杂的程序。

与传统语言不同的是，Shell 用于指定条件值的不是布尔运算式，而是命令和字串。



（1）测试命令

测试命令用于检查某个条件是否成立，它可以进行数值、字符和文件 3 个方面的测试。

1. 数值测试

   -eg ：等于则为真

   -ne ：不等于则为真

   -gt ：大于则为真

   -ge ：大于等于则为真

   -lt ：小于则为真

   -le ：小于等于则为真

2. 字串测试

   = ：等于则为真

   != ：不等于则为真

   -z 字串 ：字符长度伪则为真

   -n 字串 ：字符长度不伪则为真

3. 文件测试

   -e 文件名：如果文件存在则为真

   -r 文件名：如果文件存在且可读则为真

   -w 文件名：如果文件存在且可写则为真

   -x 文件名：如果文件存在且可执行为真

   -s 文件名：如果文件存在且至少有一个字符则为真

   -d 文件名：如果文件存在且为目录则为真

   -f 文件名：如果文件存在且为普通文件则为真

   -c 文件名：如果文件存在且为字符型特殊文件则为真

   -b 文件名：如果文件存在且为块特殊文件则为真

   

4. 测试时使用逻辑操作符

   Shell 提供 3 种逻辑操作完成此功能

   -a ：逻辑与，操作符两边均为真，结果为真，否则为假。

   -o ：逻辑或，操作符两边一边为真，结果为真，否则为假

   ! ：逻辑否，条件为假，结果为真

   其优先级为：! 最高，-a 次之， -o 最低

（2）if 条件语句

if 语句测试条件，测试条件返回真（0）或假（1）后，可相应执行一系列语句。if 语句结构对错误检查非常有用。其格式为

if 条件 1

​	then 命令1

elif 条件2

​	then 命令2

else 命令3

fi



if 语句必须以单词 fi 终止。elif 和 else 为可选项，如果语句中没有否则部分，那么就不需要 elif 和 else 部分。if 语句可以有许多 elif 部分。最常用的 if 语句是 if then fi 结构。



注：使用 if 语句时，必须将 then 部分放在新行，否则会产生错误。如果不分行，必须使用命令行分隔符。现在简单 if 语句变为

if 语句

then 命令

fi



有时要嵌入 if 语句，为此需注意 if 与 fi 的相应匹配使用。而测试两个以上的条件需使用 if then else 语句的 elif 部分。



（3）case 语句

case 语句为多选择语句，可以用 case 语句匹配一个值与一个模式，如果匹配成功，执行相匹配的命令。



case 语句格式如下：

case 值 in

​	模式1 )

​		命令1;;

​	模式2 )

​		命令2;;

​	...

​		命令

esac



case 取值后面必须为 in，每个模式必须以右括号结束。取值可以为变量或常数。匹配发现取值符合某一 模式后，其间所有命令开始执行直至;;。取值将检测匹配的每个模式。一旦模式匹配，则执行完匹配模式相应命令后不再继续其他模式。



（4）for 循环

for 循环对一个变量的可能的值都执行一个命令序列。赋给变量的几个数值既可以在程序内以数值列表的形式提供，也可以在程序外以位置参数的形式提供。for 循环一般格式为

for 变量名 in 列表

​	do 

​		命令1

​		命令2

​		...

​	done



变量名可以是用户选择的任何字串，如果变量名是 var，则在 in 之后给出的数值将顺序替换循环命令列表中的 $var。如果省略了 in，则变量 var 的取值将是位置参数。对变量的每一个可能的赋值都将执行 do 和 done 之间的命令列表。

















